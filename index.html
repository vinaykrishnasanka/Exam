<!DOCTYPE html>
<html>
<head>
    <title>Python Online Test</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: white;
        }

        .quiz-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 900px;
            margin: auto;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
        }

        .question {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 5px;
            background: #f2f2f2;
        }

        .options label {
            display: block;
            margin: 5px 0;
            cursor: pointer;
        }

        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background: #45a049;
        }

        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
        }

        .correct { color: green; }
        .wrong { color: red; }

        input[type="text"]{
            padding:8px;
            width:300px;
            margin-bottom:15px;
        }
    </style>
</head>
<body>

<h1>Python Basic Test (25 Questions)</h1>

<div class="quiz-container">

    <label><b>Candidate Name:</b></label><br>
    <input type="text" id="studentName" placeholder="Enter your name"><br>

    <form id="quizForm"></form>
    <button onclick="submitQuiz()">Submit Test</button>
    <div id="result"></div>
</div>

<script>

const questions = [
    {q:"1. What is the output of print([1,2,3] + [4,5]) ?", 
     options:["[1,2,3,4,5]","[5,7,8]","Error","[1,2,3][4,5]"], answer:0},

    {q:"2. What will be the output of print(10 > 5 and 5 > 8)?", 
     options:["True","False","None","Error"], answer:1},

    {q:"3. What is the output of print('Python'.lower()) ?", 
     options:["PYTHON","python","Python","Error"], answer:1},

    {q:"4. Which of the following is used to handle exceptions finally?", 
     options:["catch","end","finally","close"], answer:2},

    {q:"5. What is the output of print(list(range(2,6))) ?", 
     options:["[2,3,4,5]","[2,3,4,5,6]","[1,2,3,4,5]","range(2,6)"], answer:0},

    {q:"6. What will print(type({})) output?", 
     options:["<class 'set'>","<class 'dict'>","<class 'list'>","Error"], answer:1},

    {q:"7. What is the output of print(5 == 5.0)?", 
     options:["True","False","Error","None"], answer:0},

    {q:"8. Which method is used to convert all characters to uppercase?", 
     options:["upper()","capitalize()","title()","case()"], answer:0},

    {q:"9. What is the output of print(len([1,[2,3],4])) ?", 
     options:["4","3","2","Error"], answer:1},

    {q:"10. What will print(3 * 2 ** 2) output?", 
     options:["36","12","24","18"], answer:1},

    {q:"11. Which of the following creates a set?", 
     options:["{1,2,3}","[1,2,3]","(1,2,3)","{'1':'a'}"], answer:0},

    {q:"12. What is the output of print('abc' * 0)?", 
     options:["abc","0","''","Error"], answer:2},

    {q:"13. Which keyword is used to create an anonymous function?", 
     options:["def","lambda","func","anon"], answer:1},

    {q:"14. What will print(bool([ ])) output?", 
     options:["True","False","None","Error"], answer:1},

    {q:"15. What is the output of print(7 // 3)?", 
     options:["2.33","2","3","1"], answer:1},

    {q:"16. What does dict.keys() return?", 
     options:["Values","Keys","Items","Dictionary object"], answer:1},

    {q:"17. What is the output of print(4 in [1,2,3,4]) ?", 
     options:["True","False","None","Error"], answer:0},

    {q:"18. What will print('Hello'[::-1]) output?", 
     options:["Hello","olleH","Error","None"], answer:1},

    {q:"19. Which function returns the maximum value?", 
     options:["top()","high()","max()","greatest()"], answer:2},

    {q:"20. What is the output of print(2 != 3)?", 
     options:["True","False","None","Error"], answer:0},

    {q:"21. What does list.append() return?", 
     options:["New list","None","Element","True"], answer:1},

    {q:"22. What is the output of print(type(True)) ?", 
     options:["<class 'bool'>","<class 'int'>","bool","Error"], answer:0},

    {q:"23. What is the output of print({1,2,3} & {2,3,4}) ?", 
     options:["{2,3}","{1,4}","{1,2,3,4}","Error"], answer:0},

    {q:"24. What will print('5' + '5') output?", 
     options:["10","55","Error","5 5"], answer:1},

    {q:"25. Which method removes and returns last element of list?", 
     options:["remove()","pop()","delete()","discard()"], answer:1}
];


const quizForm = document.getElementById("quizForm");

questions.forEach((item, index) => {
    let div = document.createElement("div");
    div.className = "question";
    div.innerHTML = `<p>${item.q}</p>`;
    
    item.options.forEach((opt, i) => {
        div.innerHTML += `
            <div class="options">
                <label>
                    <input type="radio" name="q${index}" value="${i}"> ${opt}
                </label>
            </div>
        `;
    });

    quizForm.appendChild(div);
});

function submitQuiz() {

    const name = document.getElementById("studentName").value.trim();

    if(name === ""){
        alert("⚠ Please enter candidate name.");
        return;
    }

    // Check if all questions answered
    for(let i=0;i<questions.length;i++){
        let selected = document.querySelector(`input[name="q${i}"]:checked`);
        if(!selected){
            alert("⚠ Please answer all 25 questions before submitting.");
            return;
        }
    }

    let score = 0;
    let resultHTML = "";

    questions.forEach((item, index) => {
        let selected = document.querySelector(`input[name="q${index}"]:checked`);
        if(parseInt(selected.value) === item.answer) {
            score++;
            resultHTML += `<p class="correct">Q${index+1}: Correct</p>`;
        } else {
            resultHTML += `<p class="wrong">Q${index+1}: Wrong (Correct Answer: ${item.options[item.answer]})</p>`;
        }
    });

    resultHTML = `<h3>Your Score: ${score}/25</h3>` + resultHTML;
    document.getElementById("result").innerHTML = resultHTML;

    saveToExcel(name, score);
}

function saveToExcel(name, score){

    const now = new Date();
    const data = [
        ["Candidate Name", name],
        ["Date", now.toLocaleDateString()],
        ["Time", now.toLocaleTimeString()],
        ["Score", score],
        ["Percentage", (score/25)*100 + "%"]
    ];

    const worksheet = XLSX.utils.aoa_to_sheet(data);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, "Result");

    XLSX.writeFile(workbook, "Python_Test_Result.xlsx");
}

</script>

</body>
</html>


