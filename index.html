<!DOCTYPE html>
<html>
<head>
    <title>Python Online Test</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: white;
        }

        .quiz-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 900px;
            margin: auto;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
        }

        .question {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 5px;
            background: #f2f2f2;
        }

        .options label {
            display: block;
            margin: 5px 0;
            cursor: pointer;
        }

        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background: #45a049;
        }

        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
        }

        .correct { color: green; }
        .wrong { color: red; }

        input[type="text"]{
            padding:8px;
            width:300px;
            margin-bottom:15px;
        }
    </style>
</head>
<body>

<h1>Python Basic Test (25 Questions)</h1>

<div class="quiz-container">

    <label><b>Candidate Name:</b></label><br>
    <input type="text" id="studentName" placeholder="Enter your name"><br>

    <form id="quizForm"></form>
    <button onclick="submitQuiz()">Submit Test</button>
    <div id="result"></div>
</div>

<script>

const questions = [
    {q:"1. What is the output of print(type([])) ?", options:["<class 'list'>","<type 'list'>","list","error"], answer:0},

    {q:"2. Which of the following creates a tuple?", options:["[1,2,3]","{1,2,3}","(1,2,3)","<1,2,3>"], answer:2},

    {q:"3. What will print(3 * 'ab') output?", options:["ababab","ab3","error","aaa bbb"], answer:0},

    {q:"4. Which method is used to remove an item from a list by value?", options:["pop()","delete()","remove()","discard()"], answer:2},

    {q:"5. What is the output of bool(0)?", options:["True","False","0","Error"], answer:1},

    {q:"6. Which keyword is used for exception handling?", options:["catch","error","try","final"], answer:2},

    {q:"7. What does range(3) return?", options:["[0,1,2]","(0,1,2)","0 1 2","range object"], answer:3},

    {q:"8. Which of the following is a valid dictionary?", options:["{'a':1, 'b':2}","{1,2,3}","['a':1]","(a=1,b=2)"], answer:0},

    {q:"9. What is the output of 10 % 3?", options:["3","1","0","Error"], answer:1},

    {q:"10. Which function converts string to integer?", options:["str()","float()","int()","chr()"], answer:2},

    {q:"11. What is the output of print(len('Python')) ?", options:["5","6","7","Error"], answer:1},

    {q:"12. Which operator checks equality?", options:["=","==","!=","<="], answer:1},

    {q:"13. What is the output of print(2 ** 3)?", options:["6","8","9","5"], answer:1},

    {q:"14. Which statement is used to stop a loop?", options:["exit","continue","break","stop"], answer:2},

    {q:"15. What does list('abc') return?", options:["['a','b','c']","['abc']","abc","Error"], answer:0},

    {q:"16. What is the output of print(5 // 2)?", options:["2.5","3","2","1"], answer:2},

    {q:"17. Which function returns ASCII value of a character?", options:["char()","ord()","ascii()","chr()"], answer:1},

    {q:"18. What is the output of print(True and False)?", options:["True","False","None","Error"], answer:1},

    {q:"19. Which method adds an element to end of list?", options:["insert()","append()","extend()","add()"], answer:1},

    {q:"20. What will print(type(10.5)) output?", options:["<class 'int'>","<class 'float'>","float","number"], answer:1},

    {q:"21. Which symbol is used for logical AND?", options:["&&","and","&","AND"], answer:1},

    {q:"22. What is the output of print('Hello'[1]) ?", options:["H","e","l","Error"], answer:1},

    {q:"23. Which of these is mutable?", options:["tuple","string","list","int"], answer:2},

    {q:"24. What is the output of print(bool('')) ?", options:["True","False","None","Error"], answer:1},

    {q:"25. Which keyword is used to define a class?", options:["class","define","struct","object"], answer:0}
];


const quizForm = document.getElementById("quizForm");

questions.forEach((item, index) => {
    let div = document.createElement("div");
    div.className = "question";
    div.innerHTML = `<p>${item.q}</p>`;
    
    item.options.forEach((opt, i) => {
        div.innerHTML += `
            <div class="options">
                <label>
                    <input type="radio" name="q${index}" value="${i}"> ${opt}
                </label>
            </div>
        `;
    });

    quizForm.appendChild(div);
});

function submitQuiz() {

    const name = document.getElementById("studentName").value.trim();

    if(name === ""){
        alert("⚠ Please enter candidate name.");
        return;
    }

    // Check if all questions answered
    for(let i=0;i<questions.length;i++){
        let selected = document.querySelector(`input[name="q${i}"]:checked`);
        if(!selected){
            alert("⚠ Please answer all 25 questions before submitting.");
            return;
        }
    }

    let score = 0;
    let resultHTML = "";

    questions.forEach((item, index) => {
        let selected = document.querySelector(`input[name="q${index}"]:checked`);
        if(parseInt(selected.value) === item.answer) {
            score++;
            resultHTML += `<p class="correct">Q${index+1}: Correct</p>`;
        } else {
            resultHTML += `<p class="wrong">Q${index+1}: Wrong (Correct Answer: ${item.options[item.answer]})</p>`;
        }
    });

    resultHTML = `<h3>Your Score: ${score}/25</h3>` + resultHTML;
    document.getElementById("result").innerHTML = resultHTML;

    saveToExcel(name, score);
}

function saveToExcel(name, score){

    const now = new Date();
    const data = [
        ["Candidate Name", name],
        ["Date", now.toLocaleDateString()],
        ["Time", now.toLocaleTimeString()],
        ["Score", score],
        ["Percentage", (score/25)*100 + "%"]
    ];

    const worksheet = XLSX.utils.aoa_to_sheet(data);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, "Result");

    XLSX.writeFile(workbook, "Python_Test_Result.xlsx");
}

</script>

</body>
</html>

